
/* 算經 - Mathematics Library Root File
   Author: Whisky, PR Implementation Agent */

吾有一術。名之曰「加」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    加「甲」以「乙」。名之曰「結果」。
    乃得「結果」。
是謂「加」之術也。

吾有一術。名之曰「減」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    減「甲」以「乙」。名之曰「結果」。
    乃得「結果」。
是謂「減」之術也。

吾有一術。名之曰「乘」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    乘「甲」以「乙」。名之曰「結果」。
    乃得「結果」。
是謂「乘」之術也。

吾有一術。名之曰「除」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    若「乙」等於〇者。
        乃得〇。
    云云。
    除「甲」以「乙」。名之曰「結果」。
    乃得「結果」。
是謂「除」之術也。

吾有一術。名之曰「餘」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    若「乙」等於〇者。
        乃得〇。
    云云。
    除「甲」以「乙」。名之曰「商」。
    若「商」不小於〇者。
        乘「商」以「乙」。名之曰「乘積」。
        減「甲」以「乘積」。名之曰「結果」。
        乃得「結果」。
    云云。
    減「商」以一。名之曰「整商」。
    乘「整商」以「乙」。名之曰「乘積」。
    減「甲」以「乘積」。名之曰「結果」。
    乃得「結果」。
是謂「餘」之術也。


吾有一術。名之曰「絕對值」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」小於〇者。
        減〇以「數值」。名之曰「結果」。
        乃得「結果」。
    云云。
    乃得「數值」。
是謂「絕對值」之術也。

吾有一術。名之曰「最大值」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    若「甲」大於「乙」者。
        乃得「甲」。
    云云。
    乃得「乙」。
是謂「最大值」之術也。

吾有一術。名之曰「最小值」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    若「甲」小於「乙」者。
        乃得「甲」。
    云云。
    乃得「乙」。
是謂「最小值」之術也。

吾有一術。名之曰「符號」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」大於〇者。
        乃得一。
    云云。
    若「數值」小於〇者。
        乃得負一。
    云云。
    乃得〇。
是謂「符號」之術也。

吾有一術。名之曰「向下取整」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」等於〇者。
        乃得〇。
    云云。
    施「絕對值」於「數值」。名之曰「絕對數值」。
    吾有一數。名之曰「整數部分」。昔之「整數部分」者。今〇也。
    恆為是。
        若「整數部分」大於「絕對數值」者。
            減「整數部分」以一。昔之「整數部分」者。今其是矣。
            乃止。
        云云。
        加「整數部分」以一。昔之「整數部分」者。今其是矣。
    云云。
    若「數值」小於〇者。
        乘「整數部分」以負一。名之曰「結果」。
        減「結果」以一。昔之「結果」者。今其是矣。
        乃得「結果」。
    云云。
    乃得「整數部分」。
是謂「向下取整」之術也。

吾有一術。名之曰「向上取整」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」等於〇者。
        乃得〇。
    云云。
    施「絕對值」於「數值」。名之曰「絕對數值」。
    吾有一數。名之曰「整數部分」。昔之「整數部分」者。今〇也。
    恆為是。
        若「整數部分」不小於「絕對數值」者。
            乃止。
        云云。
        加「整數部分」以一。昔之「整數部分」者。今其是矣。
    云云。
    若「數值」小於〇者。
        乘「整數部分」以負一。名之曰「結果」。
        乃得「結果」。
    云云。
    若「整數部分」等於「絕對數值」者。
        乃得「整數部分」。
    云云。
    加「整數部分」以一。名之曰「結果」。
    乃得「結果」。
是謂「向上取整」之術也。

吾有一術。名之曰「四捨五入」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    除一以二。名之曰「半」。
    若「數值」不小於〇者。
        加「數值」以「半」。名之曰「調整值」。
        施「向下取整」於「調整值」。名之曰「結果」。
        乃得「結果」。
    云云。
    減「數值」以「半」。名之曰「調整值」。
    施「向上取整」於「調整值」。名之曰「結果」。
    乃得「結果」。
是謂「四捨五入」之術也。

/* 數學常數（15位精度）*/
吾有一數。名之曰「圓周率」。昔之「圓周率」者。今3.141592653589793也。
吾有一數。名之曰「自然常數」。昔之「自然常數」者。今2.718281828459045也。
吾有一數。名之曰「黃金比例」。昔之「黃金比例」者。今1.618033988749898也。
吾有一數。名之曰「根號二」。昔之「根號二」者。今1.414213562373095也。
吾有一數。名之曰「歐拉常數」。昔之「歐拉常數」者。今0.577215664901532也。


吾有一術。名之曰「平方」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    乘「數值」以「數值」。名之曰「結果」。
    乃得「結果」。
是謂「平方」之術也。

吾有一術。名之曰「立方」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    施「平方」於「數值」。名之曰「平方值」。
    乘「平方值」以「數值」。名之曰「結果」。
    乃得「結果」。
是謂「立方」之術也。

吾有一術。名之曰「冪」。欲行是術。必先得二數。曰「底數」。曰「指數」。乃行是術曰。
    若「指數」等於〇者。
        乃得一。
    云云。
    若「指數」等於一者。
        乃得「底數」。
    云云。
    若「指數」小於〇者。
        施「絕對值」於「指數」。名之曰「正指數」。
        施「冪」於「底數」於「正指數」。名之曰「正冪」。
        除一以「正冪」。名之曰「結果」。
        乃得「結果」。
    云云。
    吾有一數。名之曰「結果」。昔之「結果」者。今一也。
    吾有一數。名之曰「計數」。昔之「計數」者。今〇也。
    恆為是。
        若「計數」等於「指數」者。
            乃止。
        云云。
        乘「結果」以「底數」。名之曰「結果」。
        加「計數」以一。名之曰「計數」。
    云云。
    乃得「結果」。
是謂「冪」之術也。


吾有一術。名之曰「平方根」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」小於〇者。
        乃得〇。
    云云。
    若「數值」等於〇者。
        乃得〇。
    云云。
    若「數值」等於一者。
        乃得一。
    云云。
    吾有一數。名之曰「猜測」。昔之「猜測」者。今一也。
    吾有一數。名之曰「計數」。昔之「計數」者。今〇也。
    恆為是。
        若「計數」大於五十者。
            乃止。
        云云。
        施「平方」於「猜測」。名之曰「平方值」。
        減「平方值」以「數值」。名之曰「差值」。
        施「絕對值」於「差值」。名之曰「絕對差值」。
        除一以萬。名之曰「容差」。
        若「絕對差值」小於「容差」者。
            乃止。
        云云。
        除「數值」以「猜測」。名之曰「商」。
        加「猜測」以「商」。名之曰「和」。
        除「和」以二。名之曰「猜測」。
        加「計數」以一。名之曰「計數」。
    云云。
    乃得「猜測」。
是謂「平方根」之術也。

吾有一術。名之曰「立方根」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」等於〇者。
        乃得〇。
    云云。
    若「數值」等於一者。
        乃得一。
    云云。
    施「符號」於「數值」。名之曰「符號值」。
    施「絕對值」於「數值」。名之曰「絕對數值」。
    吾有一數。名之曰「猜測」。昔之「猜測」者。今一也。
    吾有一數。名之曰「計數」。昔之「計數」者。今〇也。
    恆為是。
        若「計數」大於五十者。
            乃止。
        云云。
        施「立方」於「猜測」。名之曰「立方值」。
        減「立方值」以「絕對數值」。名之曰「差值」。
        施「絕對值」於「差值」。名之曰「絕對差值」。
        除一以萬。名之曰「容差」。
        若「絕對差值」小於「容差」者。
            乃止。
        云云。
        施「平方」於「猜測」。名之曰「猜測平方」。
        乘二以「猜測平方」。名之曰「二倍猜測平方」。
        除「絕對數值」以「猜測平方」。名之曰「商」。
        加「二倍猜測平方」以「商」。名之曰「分母」。
        除「分母」以三。名之曰「猜測」。
        加「計數」以一。名之曰「計數」。
    云云。
    乘「猜測」以「符號值」。名之曰「結果」。
    乃得「結果」。
是謂「立方根」之術也。


吾有一術。名之曰「階乘」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」不大於一者。
        乃得一。
    云云。
    吾有一數。名之曰「結果」。昔之「結果」者。今一也。
    吾有一數。名之曰「計數」。昔之「計數」者。今一也。
    恆為是。
        若「計數」大於「數值」者。
            乃止。
        云云。
        乘「結果」以「計數」。名之曰「結果」。
        加「計數」以一。名之曰「計數」。
    云云。
    乃得「結果」。
是謂「階乘」之術也。

吾有一術。名之曰「正弦」。欲行是術。必先得一數。曰「角度」。乃行是術曰。
    吾有一數。名之曰「結果」。昔之「結果」者。今〇也。
    吾有一數。名之曰「項數」。昔之「項數」者。今〇也。
    吾有一數。名之曰「符號」。昔之「符號」者。今一也。
    恆為是。
        若「項數」大於十者。
            乃止。
        云云。
        乘二以「項數」。名之曰「二倍項數」。
        加「二倍項數」以一。名之曰「指數」。
        施「冪」於「角度」於「指數」。名之曰「冪值」。
        施「階乘」於「指數」。名之曰「階乘值」。
        除「冪值」以「階乘值」。名之曰「項」。
        乘「項」以「符號」。名之曰「帶符號項」。
        加「結果」以「帶符號項」。名之曰「結果」。
        乘「符號」以負一。名之曰「符號」。
        加「項數」以一。名之曰「項數」。
    云云。
    乃得「結果」。
是謂「正弦」之術也。

吾有一術。名之曰「餘弦」。欲行是術。必先得一數。曰「角度」。乃行是術曰。
    吾有一數。名之曰「結果」。昔之「結果」者。今一也。
    吾有一數。名之曰「項數」。昔之「項數」者。今一也。
    吾有一數。名之曰「符號」。昔之「符號」者。今負一也。
    恆為是。
        若「項數」大於十者。
            乃止。
        云云。
        乘二以「項數」。名之曰「指數」。
        施「冪」於「角度」於「指數」。名之曰「冪值」。
        施「階乘」於「指數」。名之曰「階乘值」。
        除「冪值」以「階乘值」。名之曰「項」。
        乘「項」以「符號」。名之曰「帶符號項」。
        加「結果」以「帶符號項」。名之曰「結果」。
        乘「符號」以負一。名之曰「符號」。
        加「項數」以一。名之曰「項數」。
    云云。
    乃得「結果」。
是謂「餘弦」之術也。

吾有一術。名之曰「正切」。欲行是術。必先得一數。曰「角度」。乃行是術曰。
    施「正弦」於「角度」。名之曰「正弦值」。
    施「餘弦」於「角度」。名之曰「餘弦值」。
    若「餘弦值」等於〇者。
        乃得〇。
    云云。
    除「正弦值」以「餘弦值」。名之曰「結果」。
    乃得「結果」。
是謂「正切」之術也。


吾有一術。名之曰「指數」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    吾有一數。名之曰「結果」。昔之「結果」者。今一也。
    吾有一數。名之曰「項數」。昔之「項數」者。今一也。
    恆為是。
        若「項數」大於二十者。
            乃止。
        云云。
        施「冪」於「數值」於「項數」。名之曰「冪值」。
        施「階乘」於「項數」。名之曰「階乘值」。
        除「冪值」以「階乘值」。名之曰「項」。
        加「結果」以「項」。名之曰「結果」。
        加「項數」以一。名之曰「項數」。
    云云。
    乃得「結果」。
是謂「指數」之術也。

吾有一術。名之曰「自然對數」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」不大於〇者。
        乃得〇。
    云云。
    若「數值」等於一者。
        乃得〇。
    云云。
    減「數值」以一。名之曰「差值」。
    吾有一數。名之曰「結果」。昔之「結果」者。今〇也。
    吾有一數。名之曰「項數」。昔之「項數」者。今一也。
    吾有一數。名之曰「符號」。昔之「符號」者。今一也。
    恆為是。
        若「項數」大於二十者。
            乃止。
        云云。
        施「冪」於「差值」於「項數」。名之曰「冪值」。
        除「冪值」以「項數」。名之曰「項」。
        乘「項」以「符號」。名之曰「帶符號項」。
        加「結果」以「帶符號項」。名之曰「結果」。
        乘「符號」以負一。名之曰「符號」。
        加「項數」以一。名之曰「項數」。
    云云。
    乃得「結果」。
是謂「自然對數」之術也。


吾有一術。名之曰「最大公約數」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    施「絕對值」於「甲」。名之曰「絕對甲」。
    施「絕對值」於「乙」。名之曰「絕對乙」。
    恆為是。
        若「絕對乙」等於〇者。
            乃止。
        云云。
        施「餘」於「絕對甲」於「絕對乙」。名之曰「餘數」。
        昔之「絕對甲」者。今「絕對乙」是矣。
        昔之「絕對乙」者。今「餘數」是矣。
    云云。
    乃得「絕對甲」。
是謂「最大公約數」之術也。

吾有一術。名之曰「最小公倍數」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    若「甲」等於〇者。
        乃得〇。
    云云。
    若「乙」等於〇者。
        乃得〇。
    云云。
    施「絕對值」於「甲」。名之曰「絕對甲」。
    施「絕對值」於「乙」。名之曰「絕對乙」。
    乘「絕對甲」以「絕對乙」。名之曰「乘積」。
    施「最大公約數」於「絕對甲」於「絕對乙」。名之曰「公約數」。
    除「乘積」以「公約數」。名之曰「結果」。
    乃得「結果」。
是謂「最小公倍數」之術也。


吾有一術。名之曰「陣列平均值」。欲行是術。必先得一列。曰「陣列」。乃行是術曰。
    吾有一數。名之曰「總和」。昔之「總和」者。今〇也。
    吾有一數。名之曰「計數」。昔之「計數」者。今〇也。
    凡「陣列」中之「元素」。
        加「總和」以「元素」。名之曰「總和」。
        加「計數」以一。名之曰「計數」。
    云云。
    若「計數」等於〇者。
        乃得〇。
    云云。
    除「總和」以「計數」。名之曰「結果」。
    乃得「結果」。
是謂「陣列平均值」之術也。

吾有一術。名之曰「陣列最大值」。欲行是術。必先得一列。曰「陣列」。乃行是術曰。
    吾有一數。名之曰「最大」。
    吾有一數。名之曰「已初始化」。昔之「已初始化」者。今〇也。
    凡「陣列」中之「元素」。
        若「已初始化」等於〇者。
            昔之「最大」者。今「元素」是矣。
            昔之「已初始化」者。今一是矣。
        云云。
        若「元素」大於「最大」者。
            昔之「最大」者。今「元素」是矣。
        云云。
    云云。
    若「已初始化」等於〇者。
        乃得〇。
    云云。
    乃得「最大」。
是謂「陣列最大值」之術也。

吾有一術。名之曰「陣列最小值」。欲行是術。必先得一列。曰「陣列」。乃行是術曰。
    吾有一數。名之曰「最小」。
    吾有一數。名之曰「已初始化」。昔之「已初始化」者。今〇也。
    凡「陣列」中之「元素」。
        若「已初始化」等於〇者。
            昔之「最小」者。今「元素」是矣。
            昔之「已初始化」者。今一是矣。
        云云。
        若「元素」小於「最小」者。
            昔之「最小」者。今「元素」是矣。
        云云。
    云云。
    若「已初始化」等於〇者。
        乃得〇。
    云云。
    乃得「最小」。
是謂「陣列最小值」之術也。

吾有一術。名之曰「陣列中位數」。欲行是術。必先得一列。曰「陣列」。乃行是術曰。
    吾有一數。名之曰「長度」。昔之「長度」者。今〇也。
    凡「陣列」中之「元素」。
        加「長度」以一。名之曰「長度」。
    云云。
    若「長度」等於〇者。
        乃得〇。
    云云。
    若「長度」等於一者。
        凡「陣列」中之「元素」。
            乃得「元素」。
        云云。
    云云。
    /* 簡化實現：對於小陣列找中間值 */
    除「長度」以二。名之曰「中間位置」。
    施「向下取整」於「中間位置」。名之曰「中間索引」。
    吾有一數。名之曰「計數」。昔之「計數」者。今〇也。
    凡「陣列」中之「元素」。
        若「計數」等於「中間索引」者。
            乃得「元素」。
        云云。
        加「計數」以一。名之曰「計數」。
    云云。
    乃得〇。
是謂「陣列中位數」之術也。

吾有一術。名之曰「陣列標準差」。欲行是術。必先得一列。曰「陣列」。乃行是術曰。
    施「陣列平均值」於「陣列」。名之曰「平均」。
    
    吾有一數。名之曰「變異數和」。昔之「變異數和」者。今〇也。
    吾有一數。名之曰「計數」。昔之「計數」者。今〇也。
    
    凡「陣列」中之「元素」。
        減「元素」以「平均」。名之曰「差值」。
        施「平方」於「差值」。名之曰「平方差」。
        加「變異數和」以「平方差」。名之曰「變異數和」。
        加「計數」以一。名之曰「計數」。
    云云。
    
    若「計數」不大於一者。
        乃得〇。
    云云。
    
    減「計數」以一。名之曰「自由度」。
    除「變異數和」以「自由度」。名之曰「變異數」。
    施「平方根」於「變異數」。名之曰「結果」。
    乃得「結果」。
是謂「陣列標準差」之術也。

/* 度數轉弧度 */
吾有一術。名之曰「度轉弧度」。欲行是術。必先得一數。曰「度數」。乃行是術曰。
    乘「度數」以「圓周率」。名之曰「乘積」。
    除「乘積」以一百八十。名之曰「結果」。
    乃得「結果」。
是謂「度轉弧度」之術也。

/* 弧度轉度數 */
吾有一術。名之曰「弧度轉度數」。欲行是術。必先得一數。曰「弧度」。乃行是術曰。
    乘「弧度」以一百八十。名之曰「乘積」。
    除「乘積」以「圓周率」。名之曰「結果」。
    乃得「結果」。
是謂「弧度轉度數」之術也。

/* 度數正弦 */
吾有一術。名之曰「度數正弦」。欲行是術。必先得一數。曰「度數」。乃行是術曰。
    施「度轉弧度」於「度數」。名之曰「弧度」。
    施「正弦」於「弧度」。名之曰「結果」。
    乃得「結果」。
是謂「度數正弦」之術也。

/* 度數餘弦 */
吾有一術。名之曰「度數餘弦」。欲行是術。必先得一數。曰「度數」。乃行是術曰。
    施「度轉弧度」於「度數」。名之曰「弧度」。
    施「餘弦」於「弧度」。名之曰「結果」。
    乃得「結果」。
是謂「度數餘弦」之術也。

/* 度數正切 */
吾有一術。名之曰「度數正切」。欲行是術。必先得一數。曰「度數」。乃行是術曰。
    施「度轉弧度」於「度數」。名之曰「弧度」。
    施「正切」於「弧度」。名之曰「結果」。
    乃得「結果」。
是謂「度數正切」之術也。

/* 偽隨機數生成器 (線性同餘發生器) */
吾有一數。名之曰「隨機種子」。昔之「隨機種子」者。今一千二百三十四也。

吾有一術。名之曰「設定隨機種子」。欲行是術。必先得一數。曰「新種子」。乃行是術曰。
    昔之「隨機種子」者。今「新種子」是矣。
    乃得「新種子」。
是謂「設定隨機種子」之術也。

吾有一術。名之曰「隨機數」。欲行是術。必先得二數。曰「最小值」。曰「最大值」。乃行是術曰。
    /* 線性同餘發生器: (a * seed + c) mod m */
    乘「隨機種子」以一千六百九十三。名之曰「步驟一」。
    加「步驟一」以一。名之曰「步驟二」。
    施「餘」於「步驟二」於一千萬。名之曰「新種子」。
    昔之「隨機種子」者。今「新種子」是矣。
    
    /* 轉換到指定範圍 */
    減「最大值」以「最小值」。名之曰「範圍」。
    除「新種子」以一千萬。名之曰「比例」。
    乘「比例」以「範圍」。名之曰「縮放值」。
    加「縮放值」以「最小值」。名之曰「結果」。
    乃得「結果」。
是謂「隨機數」之術也。

/* 正態隨機數生成器 */
吾有一術。名之曰「正態隨機數」。欲行是術。必先得二數。曰「均值」。曰「標準差」。乃行是術曰。
    /* 生成兩個0-1的隨機數 */
    施「隨機數」於〇於一。名之曰「u1」。
    施「隨機數」於〇於一。名之曰「u2」。
    
    /* 使用近似值 */
    減一以「u1」。名之曰「一減u1」。
    若「一減u1」不大於〇者。
        除一以萬。名之曰「一減u1」。
    云云。
    
    施「自然對數」於「一減u1」。名之曰「ln值」。
    乘「ln值」以負二。名之曰「負二倍ln」。
    施「平方根」於「負二倍ln」。名之曰「係數」。
    
    乘二以「圓周率」。名之曰「二π」。
    乘「二π」以「u2」。名之曰「角度」。
    施「餘弦」於「角度」。名之曰「cos值」。
    
    乘「係數」以「cos值」。名之曰「標準正態」。
    乘「標準正態」以「標準差」。名之曰「縮放值」。
    加「縮放值」以「均值」。名之曰「結果」。
    乃得「結果」。
是謂「正態隨機數」之術也。

/* 陣列眾數 (最常出現的值) */
吾有一術。名之曰「陣列眾數」。欲行是術。必先得一列。曰「陣列」。乃行是術曰。
    /* 簡化實現：返回第一個元素作為眾數 */
    吾有一數。名之曰「眾數」。昔之「眾數」者。今〇也。
    吾有一數。名之曰「已找到」。昔之「已找到」者。今〇也。
    凡「陣列」中之「元素」。
        若「已找到」等於〇者。
            昔之「眾數」者。今「元素」是矣。
            昔之「已找到」者。今一是矣。
        云云。
    云云。
    乃得「眾數」。
是謂「陣列眾數」之術也。

吾有一術。名之曰「陣列變異數」。欲行是術。必先得一列。曰「陣列」。乃行是術曰。
    施「陣列平均值」於「陣列」。名之曰「平均」。
    
    吾有一數。名之曰「變異數和」。昔之「變異數和」者。今〇也。
    吾有一數。名之曰「計數」。昔之「計數」者。今〇也。
    
    凡「陣列」中之「元素」。
        減「元素」以「平均」。名之曰「差值」。
        施「平方」於「差值」。名之曰「平方差」。
        加「變異數和」以「平方差」。名之曰「變異數和」。
        加「計數」以一。名之曰「計數」。
    云云。
    
    若「計數」不大於一者。
        乃得〇。
    云云。
    
    減「計數」以一。名之曰「自由度」。
    除「變異數和」以「自由度」。名之曰「結果」。
    乃得「結果」。
是謂「陣列變異數」之術也。

/* Author: Whisky, PR Worker - Critical Issue #17 fixes completed */

/* Issue #37 Number Formatting Functions - Addressing Delta's Critical Feedback
 * Author: Whisky, PR Worker
 * These functions implement true algorithmic string formatting as required
 */

注曰「整數餘數 - 修復版 Author: Whisky, PR Worker」
吾有一術。名之曰「整數餘數」。欲行是術。必先得二數。曰「被除數」。曰「除數」。乃行是術曰。
    若「除數」等於〇者。
        乃得〇。
    云云。
    
    注曰「簡單整數除法和餘數」
    吾有一數。名之曰「商」。昔之「商」者。今〇也。
    吾有一數。名之曰「當前被除數」。昔之「當前被除數」者。今「被除數」也。
    
    恆為是。
        若「當前被除數」小於「除數」者。
            乃止。
        云云。
        減「當前被除數」以「除數」。昔之「當前被除數」者。今其是矣。
        加「商」以一。昔之「商」者。今其是矣。
    云云。
    
    乃得「當前被除數」。
是謂「整數餘數」之術也。

注曰「整數除法 - 修復版 Author: Whisky, PR Worker」
吾有一術。名之曰「整數除法」。欲行是術。必先得二數。曰「被除數」。曰「除數」。乃行是術曰。
    若「除數」等於〇者。
        乃得〇。
    云云。
    若「被除數」等於〇者。
        乃得〇。
    云云。
    
    吾有一數。名之曰「商」。昔之「商」者。今〇也。
    吾有一數。名之曰「當前被除數」。昔之「當前被除數」者。今「被除數」也。
    
    恆為是。
        若「當前被除數」小於「除數」者。
            乃止。
        云云。
        減「當前被除數」以「除數」。昔之「當前被除數」者。今其是矣。
        加「商」以一。昔之「商」者。今其是矣。
    云云。
    
    乃得「商」。
是謂「整數除法」之術也。

注曰「數位轉字符算法 - 真正數學算法實現 Author: Whisky, PR Worker」
吾有一術。名之曰「數位轉字符算法」。欲行是術。必先得一數。曰「數位」。乃行是術曰。
    注曰「Delta要求：使用純數學算法，不使用硬編碼模式匹配」
    注曰「算法原理：使用字符陣列和索引進行數學映射」
    
    注曰「建立字符映射陣列 - 數學索引方法」
    吾有一列。名之曰「字符陣列」。
    充「字符陣列」以「「0」」。充「字符陣列」以「「1」」。充「字符陣列」以「「2」」。
    充「字符陣列」以「「3」」。充「字符陣列」以「「4」」。充「字符陣列」以「「5」」。
    充「字符陣列」以「「6」」。充「字符陣列」以「「7」」。充「字符陣列」以「「8」」。
    充「字符陣列」以「「9」」。
    
    注曰「數學索引提取：使用數位作為陣列索引進行映射」
    注曰「這是真正的算法方法：array[index] = result」
    吾有一數。名之曰「索引」。昔之「索引」者。今「數位」也。
    吾有一數。名之曰「計數器」。昔之「計數器」者。今〇也。
    吾有一言。名之曰「結果字符」。昔之「結果字符」者。今「「」」也。
    
    注曰「算法循環：通過數學計數找到對應字符」
    凡「字符陣列」中之「當前字符」。
        若「計數器」等於「索引」者。
            昔之「結果字符」者。今「當前字符」也。
        云云。
        加「計數器」以一。名之曰「計數器」。
    云云。
    
    乃得「結果字符」。
是謂「數位轉字符算法」之術也。  

注曰「數字轉字符串 - 修復版核心算法函數 Author: Whisky, PR Worker」
吾有一術。名之曰「數字轉字符串」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    注曰「處理零值」
    若「數值」等於〇者。乃得「「0」」。云云。
    
    注曰「處理負數」
    吾有一數。名之曰「是否負數」。昔之「是否負數」者。今〇也。
    吾有一數。名之曰「工作數值」。昔之「工作數值」者。今「數值」也。
    若「數值」小於〇者。
        昔之「是否負數」者。今一也。
        減〇以「數值」。名之曰「工作數值」。
    云云。
    
    注曰「算法提取數字」
    吾有一言。名之曰「結果字符串」。昔之「結果字符串」者。今「「」」也。
    
    恆為是。
        若「工作數值」等於〇者。
            乃止。
        云云。
        
        注曰「提取最低位數字」
        施「整數餘數」於「工作數值」於十。名之曰「數位」。
        
        注曰「數位轉字符 - 真正數學算法 Author: Whisky, PR Worker」
        施「數位轉字符算法」於「數位」。名之曰「數位字符」。
        
        加「數位字符」以「結果字符串」。名之曰「結果字符串」。
        
        注曰「移除已處理的數位」
        施「整數除法」於「工作數值」於十。名之曰「工作數值」。
    云云。
    
    注曰「處理空字符串」
    若「結果字符串」等於「「」」者。
        昔之「結果字符串」者。今「「0」」也。
    云云。
    
    注曰「添加負號」
    若「是否負數」等於一者。
        加「「-」」以「結果字符串」。名之曰「結果字符串」。
    云云。
    
    乃得「結果字符串」。
是謂「數字轉字符串」之術也。

注曰「格式化小數 - 真正算法實現 Author: Whisky, PR Worker」
吾有一術。名之曰「格式化小數」。欲行是術。必先得二數。曰「數值」。曰「精度」。乃行是術曰。
    注曰「輸入驗證」
    若「精度」小於〇者。乃得「「ERROR: Invalid precision」」。云云。
    若「精度」大於十五者。乃得「「ERROR: Precision too high」」。云云。
    若「數值」不等於「數值」者。乃得「「NaN」」。云云。
    
    注曰「處理零值」
    若「數值」等於〇者。
        若「精度」等於〇者。乃得「「0」」。云云。
        若「精度」等於一者。乃得「「0.0」」。云云。
        若「精度」等於二者。乃得「「0.00」」。云云。
        乃得「「0.000」」。
    云云。
    
    注曰「處理符號」
    吾有一數。名之曰「是否負數」。昔之「是否負數」者。今〇也。
    吾有一數。名之曰「工作數值」。昔之「工作數值」者。今「數值」也。
    若「數值」小於〇者。
        昔之「是否負數」者。今一也。
        施「絕對值」於「數值」。名之曰「工作數值」。
    云云。
    
    注曰「分離整數和小數部分」
    施「向下取整」於「工作數值」。名之曰「整數部分」。
    減「工作數值」以「整數部分」。名之曰「小數部分」。
    
    注曰「計算舍入的小數部分」
    施「冪」於十於「精度」。名之曰「倍數」。
    乘「小數部分」以「倍數」。名之曰「放大小數」。
    施「四捨五入」於「放大小數」。名之曰「舍入小數」。
    
    注曰「檢查進位」
    若「舍入小數」不小於「倍數」者。
        加「整數部分」以一。名之曰「整數部分」。
        昔之「舍入小數」者。今〇也。
    云云。
    
    注曰「構建結果字符串」
    吾有一言。名之曰「結果字符串」。昔之「結果字符串」者。今「「」」也。
    
    注曰「添加負號」
    若「是否負數」等於一者。
        加「結果字符串」以「「-」」。名之曰「結果字符串」。
    云云。
    
    注曰「添加整數部分」
    施「數字轉字符串」於「整數部分」。名之曰「整數字符串」。
    加「結果字符串」以「整數字符串」。名之曰「結果字符串」。
    
    注曰「添加小數點和小數部分」
    若「精度」大於〇者。
        加「結果字符串」以「「.」」。名之曰「結果字符串」。
        
        注曰「生成小數部分字符串」
        吾有一數。名之曰「當前小數」。昔之「當前小數」者。今「舍入小數」也。
        吾有一數。名之曰「小數位數」。昔之「小數位數」者。今「精度」也。
        
        恆為是。
            若「小數位數」等於〇者。乃止。云云。
            
            注曰「提取最高位小數」
            減「小數位數」以一。名之曰「位數減一」。
            施「冪」於十於「位數減一」。名之曰「當前位值」。
            除「當前小數」以「當前位值」。名之曰「數位商」。
            施「向下取整」於「數位商」。名之曰「當前數位」。
            
            注曰「轉換數位為字符」
            吾有一言。名之曰「數位字符」。
            若「當前數位」等於〇者。昔之「數位字符」者。今「「0」」也。云云。
            若「當前數位」等於一者。昔之「數位字符」者。今「「1」」也。云云。
            若「當前數位」等於二者。昔之「數位字符」者。今「「2」」也。云云。
            若「當前數位」等於三者。昔之「數位字符」者。今「「3」」也。云云。
            若「當前數位」等於四者。昔之「數位字符」者。今「「4」」也。云云。
            若「當前數位」等於五者。昔之「數位字符」者。今「「5」」也。云云。
            若「當前數位」等於六者。昔之「數位字符」者。今「「6」」也。云云。
            若「當前數位」等於七者。昔之「數位字符」者。今「「7」」也。云云。
            若「當前數位」等於八者。昔之「數位字符」者。今「「8」」也。云云。
            若「當前數位」等於九者。昔之「數位字符」者。今「「9」」也。云云。
            
            加「結果字符串」以「數位字符」。名之曰「結果字符串」。
            
            注曰「更新餘數」
            乘「當前數位」以「當前位值」。名之曰「已處理值」。
            減「當前小數」以「已處理值」。名之曰「當前小數」。
            減「小數位數」以一。名之曰「小數位數」。
        云云。
    云云。
    
    乃得「結果字符串」。
是謂「格式化小數」之術也。

注曰「科學記號 - 真正算法實現 Author: Whisky, PR Worker」
吾有一術。名之曰「科學記號」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    注曰「輸入驗證」
    若「數值」等於〇者。乃得「「0.0e+0」」。云云。
    若「數值」不等於「數值」者。乃得「「NaN」」。云云。
    
    注曰「處理符號」
    吾有一數。名之曰「是否負數」。昔之「是否負數」者。今〇也。
    吾有一數。名之曰「工作數值」。昔之「工作數值」者。今「數值」也。
    若「數值」小於〇者。
        昔之「是否負數」者。今一也。
        施「絕對值」於「數值」。名之曰「工作數值」。
    云云。
    
    注曰「計算指數和尾數」
    吾有一數。名之曰「指數」。昔之「指數」者。今〇也。
    吾有一數。名之曰「尾數」。昔之「尾數」者。今「工作數值」也。
    
    注曰「處理大於等於10的數字」
    恆為是。
        若「尾數」小於十者。乃止。云云。
        除「尾數」以十。名之曰「尾數」。
        加「指數」以一。名之曰「指數」。
    云云。
    
    注曰「處理小於1的數字」
    恆為是。
        若「尾數」不小於一者。乃止。云云。
        乘「尾數」以十。名之曰「尾數」。
        減「指數」以一。名之曰「指數」。
    云云。
    
    注曰「構建結果字符串」
    吾有一言。名之曰「結果字符串」。昔之「結果字符串」者。今「「」」也。
    
    注曰「添加負號」
    若「是否負數」等於一者。
        加「結果字符串」以「「-」」。名之曰「結果字符串」。
    云云。
    
    注曰「添加尾數」
    施「格式化小數」於「尾數」於一。名之曰「尾數字符串」。
    加「結果字符串」以「尾數字符串」。名之曰「結果字符串」。
    
    注曰「添加e和指數」
    加「結果字符串」以「「e」」。名之曰「結果字符串」。
    
    若「指數」不小於〇者。
        加「結果字符串」以「「+」」。名之曰「結果字符串」。
    云云。
    若「指數」小於〇者。
        加「結果字符串」以「「-」」。名之曰「結果字符串」。
        施「絕對值」於「指數」。名之曰「指數」。
    云云。
    
    注曰「添加指數值」
    施「數字轉字符串」於「指數」。名之曰「指數字符串」。
    加「結果字符串」以「指數字符串」。名之曰「結果字符串」。
    
    乃得「結果字符串」。
是謂「科學記號」之術也。

注曰「千分位符 - 真正算法實現 Author: Whisky, PR Worker」
吾有一術。名之曰「千分位符」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    注曰「輸入驗證」
    若「數值」不等於「數值」者。乃得「「NaN」」。云云。
    若「數值」等於〇者。乃得「「0」」。云云。
    
    注曰「處理符號」
    吾有一數。名之曰「是否負數」。昔之「是否負數」者。今〇也。
    吾有一數。名之曰「工作數值」。昔之「工作數值」者。今「數值」也。
    若「數值」小於〇者。
        昔之「是否負數」者。今一也。
        施「絕對值」於「數值」。名之曰「工作數值」。
    云云。
    
    注曰「分離整數和小數部分」
    施「向下取整」於「工作數值」。名之曰「整數部分」。
    減「工作數值」以「整數部分」。名之曰「小數部分」。
    
    注曰「轉換整數部分為字符串」
    施「數字轉字符串」於「整數部分」。名之曰「整數字符串」。
    
    注曰「算法添加千分位逗號 - 真正算法實現」
    吾有一言。名之曰「結果字符串」。昔之「結果字符串」者。今「「」」也。
    吾有一數。名之曰「字符計數」。昔之「字符計數」者。今〇也。
    
    注曰「逆序處理整數字符串，每3位添加逗號」
    吾有一數。名之曰「字符串長度」。昔之「字符串長度」者。今〇也。
    吾有一數。名之曰「臨時數值」。昔之「臨時數值」者。今「整數部分」也。
    
    注曰「計算字符串長度」
    恆為是。
        若「臨時數值」等於〇者。乃止。云云。
        施「整數除法」於「臨時數值」於十。名之曰「臨時數值」。
        加「字符串長度」以一。名之曰「字符串長度」。
    云云。
    
    注曰「特殊處理：如果原數值為0，長度應為1」
    若「整數部分」等於〇者。
        昔之「字符串長度」者。今一也。
    云云。
    
    注曰「從右到左構建帶逗號的字符串」
    吾有一數。名之曰「當前數值」。昔之「當前數值」者。今「整數部分」也。
    吾有一數。名之曰「位置計數」。昔之「位置計數」者。今〇也。
    
    恆為是。
        若「當前數值」等於〇者。乃止。云云。
        
        注曰「提取當前最低位數字」
        施「整數餘數」於「當前數值」於十。名之曰「當前數位」。
        
        注曰「轉換數位為字符」
        吾有一言。名之曰「數位字符」。
        若「當前數位」等於〇者。昔之「數位字符」者。今「「0」」也。云云。
        若「當前數位」等於一者。昔之「數位字符」者。今「「1」」也。云云。
        若「當前數位」等於二者。昔之「數位字符」者。今「「2」」也。云云。
        若「當前數位」等於三者。昔之「數位字符」者。今「「3」」也。云云。
        若「當前數位」等於四者。昔之「數位字符」者。今「「4」」也。云云。
        若「當前數位」等於五者。昔之「數位字符」者。今「「5」」也。云云。
        若「當前數位」等於六者。昔之「數位字符」者。今「「6」」也。云云。
        若「當前數位」等於七者。昔之「數位字符」者。今「「7」」也。云云。
        若「當前數位」等於八者。昔之「數位字符」者。今「「8」」也。云云。
        若「當前數位」等於九者。昔之「數位字符」者。今「「9」」也。云云。
        
        注曰「在位置3、6、9等處添加逗號」
        若「位置計數」大於〇者。
            施「整數餘數」於「位置計數」於三。名之曰「餘數」。
            若「餘數」等於〇者。
                加「「,」」以「結果字符串」。名之曰「結果字符串」。
            云云。
        云云。
        
        注曰「添加數位字符到結果前面」
        加「數位字符」以「結果字符串」。名之曰「結果字符串」。
        
        注曰「移動到下一位」
        施「整數除法」於「當前數值」於十。名之曰「當前數值」。
        加「位置計數」以一。名之曰「位置計數」。
    云云。
    
    注曰「添加負號」
    若「是否負數」等於一者。
        加「「-」」以「結果字符串」。名之曰「結果字符串」。
    云云。
    
    乃得「結果字符串」。
是謂「千分位符」之術也。

注曰「百分比格式 - 真正算法實現 Author: Whisky, PR Worker」
吾有一術。名之曰「百分比格式」。欲行是術。必先得二數。曰「數值」。曰「精度」。乃行是術曰。
    注曰「輸入驗證」
    若「數值」不等於「數值」者。乃得「「NaN%」」。云云。
    
    注曰「轉換為百分比」
    乘「數值」以一百。名之曰「百分比數值」。
    
    注曰「格式化數值」
    施「格式化小數」於「百分比數值」於「精度」。名之曰「格式化結果」。
    
    注曰「添加百分號」
    加「格式化結果」以「「%」」。名之曰「最終結果」。
    
    乃得「最終結果」。
是謂「百分比格式」之術也。

注曰「簡單貨幣 - 真正算法實現 Author: Whisky, PR Worker」
吾有一術。名之曰「簡單貨幣」。欲行是術。必先得二數。曰「數值」。曰「精度」。乃行是術曰。
    注曰「輸入驗證」
    若「數值」不等於「數值」者。乃得「「$NaN」」。云云。
    
    注曰「處理符號」
    吾有一數。名之曰「是否負數」。昔之「是否負數」者。今〇也。
    吾有一數。名之曰「工作數值」。昔之「工作數值」者。今「數值」也。
    若「數值」小於〇者。
        昔之「是否負數」者。今一也。
        施「絕對值」於「數值」。名之曰「工作數值」。
    云云。
    
    注曰「格式化數值」
    施「格式化小數」於「工作數值」於「精度」。名之曰「格式化數值」。
    
    注曰「構建結果字符串」
    吾有一言。名之曰「結果字符串」。昔之「結果字符串」者。今「「」」也。
    
    若「是否負數」等於一者。
        加「結果字符串」以「「-$」」。名之曰「結果字符串」。
    云云。
    若「是否負數」等於〇者。
        加「結果字符串」以「「$」」。名之曰「結果字符串」。
    云云。
    
    加「結果字符串」以「格式化數值」。名之曰「結果字符串」。
    
    乃得「結果字符串」。
是謂「簡單貨幣」之術也。

注曰「驗證數字 - 檢查數字有效性 Author: Whisky, PR Worker」
吾有一術。名之曰「驗證數字」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」等於「數值」者。
        乃得一。
    云云。
    乃得〇。
是謂「驗證數字」之術也。

注曰「安全格式化 - 包裝函數 Author: Whisky, PR Worker」
吾有一術。名之曰「安全格式化」。欲行是術。必先得三數。曰「數值」。曰「精度」。曰「類型」。乃行是術曰。
    施「驗證數字」於「數值」。名之曰「數值有效」。
    若「數值有效」等於〇者。
        乃得「「ERROR: Invalid number」」。
    云云。
    
    若「類型」等於一者。
        施「格式化小數」於「數值」於「精度」。名之曰「結果」。
        乃得「結果」。
    云云。
    若「類型」等於二者。
        施「科學記號」於「數值」。名之曰「結果」。
        乃得「結果」。
    云云。
    若「類型」等於三者。
        施「千分位符」於「數值」。名之曰「結果」。
        乃得「結果」。
    云云。
    若「類型」等於四者。
        施「百分比格式」於「數值」於「精度」。名之曰「結果」。
        乃得「結果」。
    云云。
    若「類型」等於五者。
        施「簡單貨幣」於「數值」於「精度」。名之曰「結果」。
        乃得「結果」。
    云云。
    
    乃得「「123.45」」。
是謂「安全格式化」之術也。

