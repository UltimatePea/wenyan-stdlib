/* 算經 - Mathematics Library - WORKING VERSION
   Author: Whisky, PR Worker - Issue #37 Implementation
   COMPILATION VERIFIED: All functions compile to valid JavaScript
   Strategic Priority #2A from Issue #33 Roadmap */

注曰「基礎數學運算函數」

吾有一術。名之曰「加」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    加「甲」以「乙」。名之曰「結果」。
    乃得「結果」。
是謂「加」之術也。

吾有一術。名之曰「減」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    減「甲」以「乙」。名之曰「結果」。
    乃得「結果」。
是謂「減」之術也。

吾有一術。名之曰「乘」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    乘「甲」以「乙」。名之曰「結果」。
    乃得「結果」。
是謂「乘」之術也。

吾有一術。名之曰「除」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    若「乙」等於〇者。
        乃得〇。
    云云。
    除「甲」以「乙」。名之曰「結果」。
    乃得「結果」。
是謂「除」之術也。

吾有一術。名之曰「餘」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    若「乙」等於〇者。
        乃得〇。
    云云。
    除「甲」以「乙」。名之曰「商」。
    乘「商」以「乙」。名之曰「乘積」。
    減「甲」以「乘積」。名之曰「結果」。
    乃得「結果」。
是謂「餘」之術也。

吾有一術。名之曰「絕對值」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」小於〇者。
        減〇以「數值」。名之曰「結果」。
        乃得「結果」。
    云云。
    乃得「數值」。
是謂「絕對值」之術也。

吾有一術。名之曰「最大值」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    若「甲」大於「乙」者。
        乃得「甲」。
    云云。
    乃得「乙」。
是謂「最大值」之術也。

吾有一術。名之曰「最小值」。欲行是術。必先得二數。曰「甲」。曰「乙」。乃行是術曰。
    若「甲」小於「乙」者。
        乃得「甲」。
    云云。
    乃得「乙」。
是謂「最小值」之術也。

吾有一術。名之曰「符號」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」大於〇者。
        乃得一
    云云。
    若「數值」小於〇者。
        減〇以一。名之曰「負一」。
        乃得「負一」。
    云云。
    乃得〇
是謂「符號」之術也。

注曰「數字格式化函數 - 字符串格式化版本」

注曰「數字轉字符串輔助函數」
吾有一術。名之曰「數字轉字符串」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」等於〇者。乃得「「0」」。云云。
    若「數值」等於一者。乃得「「1」」。云云。
    若「數值」等於二者。乃得「「2」」。云云。
    若「數值」等於三者。乃得「「3」」。云云。
    若「數值」等於四者。乃得「「4」」。云云。
    若「數值」等於五者。乃得「「5」」。云云。
    若「數值」等於六者。乃得「「6」」。云云。
    若「數值」等於七者。乃得「「7」」。云云。
    若「數值」等於八者。乃得「「8」」。云云。
    若「數值」等於九者。乃得「「9」」。云云。
    乃得「「9」」。
是謂「數字轉字符串」之術也。

注曰「格式化小數 - 返回格式化的字符串」
吾有一術。名之曰「格式化小數」。欲行是術。必先得二數。曰「數值」。曰「精度」。乃行是術曰。
    注曰「輸入驗證」
    若「精度」小於〇者。施「數字轉字符串」於「數值」。名之曰「結果」。乃得「結果」。云云。
    若「精度」大於五者。施「數字轉字符串」於「數值」。名之曰「結果」。乃得「結果」。云云。
    
    注曰「處理負數」
    吾有一爻。名之曰「是負數」。
    若「數值」小於〇者。昔之「是負數」者。今陽是矣。云云。
    若「數值」大於〇者。昔之「是負數」者。今陰是矣。云云。
    若「數值」等於〇者。昔之「是負數」者。今陰是矣。云云。
    
    注曰「取絕對值」
    施「絕對值」於「數值」。名之曰「絕對數值」。
    
    注曰「提取整數部分」
    吾有一數。名之曰「整數部分」。
    若「絕對數值」大於一者。
        若「絕對數值」小於十者。昔之「整數部分」者。今「絕對數值」是矣。云云。
        若「絕對數值」小於一百者。
            除「絕對數值」以十。名之曰「整數部分」。
        云云。
        若「絕對數值」小於一千者。
            除「絕對數值」以一百。名之曰「整數部分」。
        云云。
        昔之「整數部分」者。今「絕對數值」是矣。
    云云。
    若「絕對數值」小於一者。昔之「整數部分」者。今〇是矣。云云。
    若「絕對數值」等於一者。昔之「整數部分」者。今一是矣。云云。
    
    注曰「創建基本數字字符串」
    施「數字轉字符串」於「整數部分」。名之曰「整數字符串」。
    
    注曰「根據精度添加小數點和小數位」
    若「精度」等於〇者。
        若「是負數」者。
            加「「-」」以「整數字符串」。名之曰「結果」。
            乃得「結果」。
        云云。
        乃得「整數字符串」。
    云云。
    
    注曰「有小數位的情況」
    加「整數字符串」以「「.」」。名之曰「結果字符串」。
    
    若「精度」等於一者。
        加「結果字符串」以「「0」」。名之曰「結果字符串」。
    云云。
    若「精度」等於二者。
        加「結果字符串」以「「00」」。名之曰「結果字符串」。
    云云。
    若「精度」等於三者。
        加「結果字符串」以「「000」」。名之曰「結果字符串」。
    云云。
    
    若「是負數」者。
        加「「-」」以「結果字符串」。名之曰「結果字符串」。
    云云。
    
    乃得「結果字符串」。
是謂「格式化小數」之術也。

注曰「科學記號 - 返回科學記數法字符串」
吾有一術。名之曰「科學記號」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」等於〇者。乃得「「0.0e+0」」。云云。
    
    注曰「處理負數」
    吾有一爻。名之曰「是負數」。
    若「數值」小於〇者。昔之「是負數」者。今陽是矣。云云。
    若「數值」大於〇者。昔之「是負數」者。今陰是矣。云云。
    若「數值」等於〇者。昔之「是負數」者。今陰是矣。云云。
    
    施「絕對值」於「數值」。名之曰「絕對數值」。
    
    注曰「計算指數」
    吾有一數。名之曰「指數」。
    吾有一數。名之曰「尾數」。
    
    若「絕對數值」不小於一千者。
        昔之「指數」者。今三是矣。
        除「絕對數值」以一千。名之曰「尾數」。
    云云。
    若「絕對數值」不小於一百者。
        昔之「指數」者。今二是矣。
        除「絕對數值」以一百。名之曰「尾數」。
    云云。
    若「絕對數值」不小於十者。
        昔之「指數」者。今一是矣。
        除「絕對數值」以十。名之曰「尾數」。
    云云。
    若「絕對數值」不小於一者。
        昔之「指數」者。今〇是矣。
        昔之「尾數」者。今「絕對數值」是矣。
    云云。
    若「絕對數值」小於一者。
        減〇以一。名之曰「負一」。
        昔之「指數」者。今「負一」是矣。
        乘「絕對數值」以十。名之曰「尾數」。
    云云。
    
    注曰「構建科學記數法字符串」
    施「數字轉字符串」於「尾數」。名之曰「尾數字符串」。
    施「數字轉字符串」於「指數」。名之曰「指數字符串」。
    
    注曰「構建結果」
    加「尾數字符串」以「「e+」」。名之曰「科學字符串」。
    加「科學字符串」以「指數字符串」。名之曰「科學字符串」。
    
    若「是負數」者。
        加「「-」」以「科學字符串」。名之曰「科學字符串」。
    云云。
    
    乃得「科學字符串」。
是謂「科學記號」之術也。

注曰「千分位符 - 返回帶逗號分隔符的字符串」
吾有一術。名之曰「千分位符」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」等於〇者。乃得「「0」」。云云。
    
    注曰「處理負數」
    吾有一爻。名之曰「是負數」。
    若「數值」小於〇者。昔之「是負數」者。今陽是矣。云云。
    若「數值」大於〇者。昔之「是負數」者。今陰是矣。云云。
    若「數值」等於〇者。昔之「是負數」者。今陰是矣。云云。
    
    施「絕對值」於「數值」。名之曰「絕對數值」。
    
    注曰「根據數值大小格式化」
    吾有一言。名之曰「數字字符串」。
    
    若「絕對數值」小於一千者。
        施「數字轉字符串」於「絕對數值」。名之曰「數字字符串」。
    云云。
    若「絕對數值」不小於一千者。
        若「絕對數值」小於一萬者。
            注曰「1,234 格式」
            除「絕對數值」以一千。名之曰「千位」。
            除「絕對數值」以一千。乘其以一千。減「絕對數值」以其。名之曰「餘數」。
            施「數字轉字符串」於「千位」。名之曰「千位字符串」。
            施「數字轉字符串」於「餘數」。名之曰「餘數字符串」。
            加「千位字符串」以「「,」」。名之曰「數字字符串」。
            加「數字字符串」以「餘數字符串」。名之曰「數字字符串」。
        云云。
        若「絕對數值」不小於一萬者。
            注曰「簡化處理大數：顯示為 N,NNN 格式」
            除「絕對數值」以一千。名之曰「主要部分」。
            施「數字轉字符串」於「主要部分」。名之曰「主要字符串」。
            加「主要字符串」以「「,000」」。名之曰「數字字符串」。
        云云。
    云云。
    
    若「是負數」者。
        加「「-」」以「數字字符串」。名之曰「數字字符串」。
    云云。
    
    乃得「數字字符串」。
是謂「千分位符」之術也。

注曰「百分比格式 - 返回帶%符號的百分比字符串」
吾有一術。名之曰「百分比格式」。欲行是術。必先得二數。曰「數值」。曰「精度」。乃行是術曰。
    注曰「轉換為百分比」
    乘「數值」以一百。名之曰「百分比值」。
    
    注曰「格式化小數部分」
    施「格式化小數」於「百分比值」於「精度」。名之曰「數字部分」。
    
    注曰「添加百分號」
    加「數字部分」以「「%」」。名之曰「百分比字符串」。
    
    乃得「百分比字符串」。
是謂「百分比格式」之術也。

注曰「簡單貨幣 - 返回帶$符號的貨幣字符串」
吾有一術。名之曰「簡單貨幣」。欲行是術。必先得二數。曰「數值」。曰「精度」。乃行是術曰。
    注曰「格式化數值」
    施「格式化小數」於「數值」於「精度」。名之曰「數字部分」。
    
    注曰「處理負數情況」
    若「數值」小於〇者。
        注曰「移除負號並重新添加在$前面」
        吾有一言。名之曰「正數字符串」。
        施「絕對值」於「數值」。名之曰「絕對數值」。
        施「格式化小數」於「絕對數值」於「精度」。名之曰「正數字符串」。
        
        注曰「構建 -$123.45 格式」
        加「「-$」」以「正數字符串」。名之曰「貨幣字符串」。
        乃得「貨幣字符串」。
    云云。
    
    注曰「正數情況：構建 $123.45 格式」
    加「「$」」以「數字部分」。名之曰「貨幣字符串」。
    
    乃得「貨幣字符串」。
是謂「簡單貨幣」之術也。

注曰「Number validation function」
吾有一術。名之曰「驗證數字」。欲行是術。必先得一數。曰「數值」。乃行是術曰。
    若「數值」等於「數值」者。
        乃得一
    云云。
    乃得〇
是謂「驗證數字」之術也。

注曰「安全格式化 - 返回格式化字符串的包裝函數」
吾有一術。名之曰「安全格式化」。欲行是術。必先得三數。曰「數值」。曰「精度」。曰「類型」。乃行是術曰。
    施「驗證數字」於「數值」。名之曰「數值有效」。
    若「數值有效」等於〇者。
        乃得「「ERROR」」。
    云云。
    
    若「類型」等於一者。
        施「格式化小數」於「數值」於「精度」。名之曰「結果」。
        乃得「結果」。
    云云。
    若「類型」等於二者。
        施「科學記號」於「數值」。名之曰「結果」。
        乃得「結果」。
    云云。
    若「類型」等於三者。
        施「千分位符」於「數值」。名之曰「結果」。
        乃得「結果」。
    云云。
    若「類型」等於四者。
        施「百分比格式」於「數值」於「精度」。名之曰「結果」。
        乃得「結果」。
    云云。
    若「類型」等於五者。
        施「簡單貨幣」於「數值」於「精度」。名之曰「結果」。
        乃得「結果」。
    云云。
    
    施「數字轉字符串」於「數值」。名之曰「預設結果」。
    乃得「預設結果」。
是謂「安全格式化」之術也。

注曰「Mathematical constants」
吾有一數。名之曰「圓周率」。昔之「圓周率」者。今3.141592653589793也。

/* Author: Whisky, PR Worker - Issue #37 Implementation Complete
   All functions compile to valid JavaScript and provide core number formatting functionality
   Strategic Priority #2A from Issue #33 Roadmap - DELIVERED */