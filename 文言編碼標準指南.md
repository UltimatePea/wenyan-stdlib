# 文言編程標準庫編碼標準指南
# Wenyan Programming Standard Library Coding Standards Guide

**版本 Version**: 2.0  
**作者 Author**: Whisky, PR Worker  
**最後更新 Last Updated**: 2025-08-03  

---

## 📋 目錄 Table of Contents

1. [總體原則 General Principles](#總體原則-general-principles)
2. [文件組織 File Organization](#文件組織-file-organization)
3. [命名規範 Naming Conventions](#命名規範-naming-conventions)
4. [代碼結構 Code Structure](#代碼結構-code-structure)
5. [註釋標準 Documentation Standards](#註釋標準-documentation-standards)
6. [函數設計 Function Design](#函數設計-function-design)
7. [錯誤處理 Error Handling](#錯誤處理-error-handling)
8. [測試要求 Testing Requirements](#測試要求-testing-requirements)
9. [性能考量 Performance Considerations](#性能考量-performance-considerations)
10. [代碼審查 Code Review](#代碼審查-code-review)
11. [示例代碼 Example Code](#示例代碼-example-code)
12. [工具和檢查 Tools and Validation](#工具和檢查-tools-and-validation)

---

## 🎯 總體原則 General Principles

### 文化適宜性 Cultural Appropriateness
- **優先使用繁體中文**：所有變量名、函數名、註釋應使用繁體中文
- **保持古典風格**：遵循文言文的簡潔優雅風格
- **雙語支持**：重要註釋和文檔提供中英文對照

### 代碼哲學 Code Philosophy
- **簡潔明了**：一個函數只做一件事
- **可讀性優先**：代碼應該自解釋
- **一致性原則**：整個項目保持統一的風格
- **健壯性**：妥善處理邊界條件和錯誤情況

### 質量標準 Quality Standards
- **零編譯錯誤**：所有代碼必須通過 wenyan 編譯器檢查
- **100% 測試覆蓋**：每個公開函數至少三個測試用例
- **性能基準**：基礎操作 < 10ms，複雜操作 < 100ms
- **文檔完整**：每個函數包含用途、參數、返回值說明

---

## 📁 文件組織 File Organization

### 目錄結構 Directory Structure
```
wenyan-stdlib/
├── libs/                    # 庫文件目錄
│   ├── 數學庫/              # Math library
│   │   ├── 基礎運算.wy      # Basic operations
│   │   ├── 高級函數.wy      # Advanced functions
│   │   └── README.md        # Library documentation
│   ├── 字符串經/            # String library
│   └── ...
├── tests/                   # 測試文件目錄
│   ├── 數學庫/              # Math library tests
│   │   ├── 測試基礎運算.wy  # Basic operations tests
│   │   └── 測試高級函數.wy  # Advanced functions tests
│   └── ...
├── examples/                # 示例代碼目錄
├── docs/                    # 文檔目錄
└── tools/                   # 工具腳本目錄
```

### 文件命名 File Naming
- **庫文件**：使用描述性中文名稱，如 `字符串處理.wy`
- **測試文件**：以 `測試` 開頭，如 `測試字符串處理.wy`
- **示例文件**：以 `示例` 開頭，如 `示例字符串使用.wy`
- **文件擴展名**：統一使用 `.wy` 擴展名

### 文件頭部模板 File Header Template
```wenyan
/*
 * [文件名] - [英文名稱]
 * Author: [作者名], [角色]
 * Version: [版本號]
 * Created: [創建日期]
 * 
 * [文件描述中文]
 * [File description in English]
 * 
 * Dependencies: [依賴項]
 * Performance: [性能特徵]
 * Thread Safety: [線程安全性]
 */
```

---

## 🏷️ 命名規範 Naming Conventions

### 變量命名 Variable Naming
- **描述性名稱**：`字符串長度` 而不是 `長度`
- **避免縮寫**：`最大值` 而不是 `最大`
- **使用名詞**：變量名應該是名詞或名詞短語
- **避免保留字**：不使用文言編程語言的保留字

**✅ 好的例子 Good Examples:**
```wenyan
吾有一言。名之曰「用戶輸入字符串」。
吾有一數。名之曰「計算結果總和」。
吾有一列。名之曰「排序後的數組」。
吾有一爻。名之曰「操作成功標誌」。
```

**❌ 避免的例子 Bad Examples:**
```wenyan
吾有一言。名之曰「字串」。        # 太簡短
吾有一數。名之曰「結果」。        # 不夠具體  
吾有一列。名之曰「arr」。         # 使用英文縮寫
吾有一爻。名之曰「標誌」。        # 太通用
```

### 函數命名 Function Naming
- **動詞+名詞**：如 `計算平均值`、`查找元素`
- **明確用途**：函數名應該清楚表達功能
- **統一格式**：同類型操作使用一致的命名模式
- **避免過長**：保持在合理長度內

**✅ 好的例子 Good Examples:**
```wenyan
吾有一術。名之曰「計算字符串長度」。
吾有一術。名之曰「查找數組元素」。
吾有一術。名之曰「排序數字列表」。
吾有一術。名之曰「驗證用戶輸入」。
```

**❌ 避免的例子 Bad Examples:**
```wenyan
吾有一術。名之曰「處理」。                    # 太模糊
吾有一術。名之曰「計算各種不同類型的統計數據」。  # 太長
吾有一術。名之曰「func1」。                  # 使用英文
```

### 常量命名 Constant Naming
- **全大寫描述**：如 `最大重試次數`、`默認超時時間`
- **使用常量前綴**：可以考慮使用 `常量` 前綴
- **表達含義**：常量名應該表達其用途和含義

```wenyan
吾有一數。名之曰「最大重試次數」。
昔之「最大重試次數」者。今三是矣。

吾有一數。名之曰「默認超時時間」。
昔之「默認超時時間」者。今五千是矣。
```

---

## 🏗️ 代碼結構 Code Structure

### 文件內部結構 File Internal Structure
```wenyan
/*
 * 文件頭部註釋
 * File header comment
 */

/* ===== 依賴引用 Dependencies ===== */
引用「基礎工具」。
引用「錯誤處理標準」。

/* ===== 常量定義 Constants ===== */
吾有一數。名之曰「最大循環次數」。
昔之「最大循環次數」者。今一千是矣。

/* ===== 全局變量 Global Variables ===== */
吾有一列。名之曰「緩存數據列表」。

/* ===== 私有輔助函數 Private Helper Functions ===== */
吾有一術。名之曰「私有驗證函數」。欲行是術。...

/* ===== 公開接口函數 Public Interface Functions ===== */
吾有一術。名之曰「公開主要功能」。欲行是術。...

/* ===== 使用示例 Usage Examples ===== */
/*
使用示例：
施「公開主要功能」於「測試數據」。
*/
```

### 函數結構 Function Structure
```wenyan
吾有一術。名之曰「[函數名稱]」。欲行是術。必先得[參數列表]。乃行是術曰。
    /* 參數驗證 Parameter Validation */
    [參數檢查代碼]
    
    /* 主要邏輯 Main Logic */
    [核心功能實現]
    
    /* 錯誤處理 Error Handling */
    [錯誤情況處理]
    
    /* 返回結果 Return Result */
    乃得[返回值]。
是謂「[函數名稱]」之術也。
```

### 縮進和格式 Indentation and Formatting
- **一致縮進**：使用4個空格縮進
- **邏輯分組**：相關代碼用空行分隔
- **對齊**：參數列表和複雜表達式適當對齊
- **行長度**：每行不超過80字符（中文字符算兩個字符）

```wenyan
吾有一術。名之曰「複雜計算函數」。欲行是術。
必先得三數二言。
    曰「第一個數值」。
    曰「第二個數值」。
    曰「第三個數值」。
    曰「計算模式」。
    曰「輸出格式」。
乃行是術曰。
    
    /* 驗證輸入參數 */
    若「第一個數值」小於〇者。
        乃得「錯誤：第一個數值不能為負」。
    云云。
    
    /* 執行計算邏輯 */
    吾有一數。名之曰「計算結果」。
    [計算邏輯]
    
    /* 格式化輸出 */
    [輸出格式化邏輯]
    
    乃得「計算結果」。
是謂「複雜計算函數」之術也。
```

---

## 📝 註釋標準 Documentation Standards

### 函數註釋模板 Function Documentation Template
```wenyan
/*
 * [函數名稱] - [Function Name]
 * 
 * 功能描述 Description:
 * [詳細描述函數的功能和用途]
 * [Detailed description of function purpose and functionality]
 * 
 * 參數 Parameters:
 * @param {類型} [參數名] - [參數描述] [Parameter description]
 * @param {類型} [參數名] - [參數描述] [Parameter description]
 * 
 * 返回值 Returns:
 * @return {類型} [返回值描述] [Return value description]
 * 
 * 異常 Exceptions:
 * @throws [異常類型] [異常條件] [Exception condition]
 * 
 * 示例 Example:
 * 施「函數名稱」於「參數1」於「參數2」。
 * 
 * 性能 Performance: O([時間複雜度])
 * 線程安全 Thread Safety: [安全/不安全] [Safe/Unsafe]
 * 版本 Since: [版本號]
 * 作者 Author: [作者名]
 */
吾有一術。名之曰「[函數名稱]」。...
```

### 行內註釋 Inline Comments
- **解釋複雜邏輯**：對難理解的代碼添加註釋
- **說明算法**：對使用的算法或公式進行說明
- **標記待辦事項**：使用 `TODO:`、`FIXME:`、`NOTE:` 標記
- **避免顯而易見**：不要為簡單明了的代碼添加註釋

```wenyan
/* 使用二分查找算法提高查找效率 Binary search for efficiency */
吾有一數。名之曰「左邊界」。
昔之「左邊界」者。今一是矣。

吾有一數。名之曰「右邊界」。
夫「數組」之長。名之曰「右邊界」。

/* TODO: 添加對空數組的特殊處理 */
/* FIXME: 處理數組未排序的情況 */
恆為是。
    /* 計算中點位置，避免整數溢出 Calculate midpoint, avoid overflow */
    吾有一數。名之曰「中點」。
    除「左邊界」「右邊界」之和以二。名之曰「中點」。
    
    [查找邏輯]
云云。
```

### 模塊級註釋 Module-Level Comments
```wenyan
/*
 * ==========================================
 * 字符串處理庫 - String Processing Library
 * ==========================================
 * 
 * 版本 Version: 2.1.0
 * 作者 Author: Whisky, PR Worker
 * 維護者 Maintainer: 標準庫團隊
 * 
 * 功能概述 Overview:
 * 提供全面的字符串處理功能，包括查找、替換、分割、格式化等操作
 * Provides comprehensive string processing functions including search, 
 * replace, split, formatting operations
 * 
 * 主要特性 Key Features:
 * - 高性能字符串操作 High-performance string operations
 * - 完整的Unicode支持 Full Unicode support  
 * - 豐富的格式化選項 Rich formatting options
 * - 強大的模式匹配 Powerful pattern matching
 * 
 * 依賴項 Dependencies:
 * - 基礎工具庫 Basic utilities library
 * - 錯誤處理標準 Error handling standards
 * 
 * 使用方法 Usage:
 * 引用「字符串處理」。
 * 施「查找子字符串」於「主字符串」於「子字符串」。
 * 
 * 性能指標 Performance Metrics:
 * - 基本操作: < 1ms
 * - 復雜模式匹配: < 10ms  
 * - 大文本處理: < 100ms
 * 
 * 線程安全 Thread Safety: 所有函數都是線程安全的
 * 內存使用 Memory Usage: 低內存占用，自動垃圾回收
 * 
 * 更新日誌 Change Log:
 * v2.1.0 - 添加Unicode支持 Added Unicode support
 * v2.0.0 - 重構核心算法 Refactored core algorithms  
 * v1.0.0 - 初始版本 Initial release
 * 
 * ==========================================
 */
```

---

## ⚙️ 函數設計 Function Design

### 函數簽名設計 Function Signature Design

#### 參數順序原則 Parameter Order Principles
1. **主要操作對象在前**：被操作的數據放在前面
2. **配置參數在後**：可選的配置和標誌放在後面
3. **輸出參數最後**：如果有輸出參數，放在最後

```wenyan
/* ✅ 好的參數順序 Good parameter order */
吾有一術。名之曰「在字符串中查找子串」。欲行是術。
必先得二言一爻。
    曰「主字符串」。      # 主要操作對象
    曰「搜索子串」。      # 次要操作對象  
    曰「區分大小寫」。    # 配置參數
乃行是術曰。
```

#### 參數驗證標準 Parameter Validation Standards
```wenyan
吾有一術。名之曰「安全除法運算」。欲行是術。
必先得二數。曰「被除數」。曰「除數」。
乃行是術曰。
    
    /* 必須進行參數驗證 Parameter validation required */
    施「驗證數值範圍」於「被除數」於負九九九九九九九九九於九九九九九九九九九於「被除數」。
    名之曰「被除數驗證結果」。
    若「被除數驗證結果」等於陰者。
        乃得「錯誤：被除數超出有效範圍」。
    云云。
    
    /* 檢查除零錯誤 Check division by zero */
    若「除數」等於〇者。
        施「格式化錯誤信息」於「錯誤類型運算」於「安全除法運算」於「除數不能為零」。
        名之曰「錯誤信息」。
        施「報告錯誤」於「錯誤信息」。
        乃得「錯誤」。
    云云。
    
    /* 執行安全除法 Perform safe division */
    除「被除數」以「除數」。乃得其也。
是謂「安全除法運算」之術也。
```

### 返回值設計 Return Value Design

#### 一致的返回值模式 Consistent Return Patterns
```wenyan
/* 成功時返回結果，失敗時返回錯誤標記 */
/* Return result on success, error marker on failure */

吾有一術。名之曰「查找數組元素」。欲行是術。
必先得一列一物。曰「數組」。曰「目標元素」。
乃行是術曰。
    
    /* 參數驗證 */
    [驗證邏輯]
    
    /* 查找邏輯 */
    [查找實現]
    
    若「找到元素」等於陽者。
        乃得「元素索引」。    # 成功：返回索引
    云云。
    
    乃得「錯誤：未找到元素」。  # 失敗：返回錯誤信息
是謂「查找數組元素」之術也。
```

#### 錯誤返回值標準化 Standardized Error Returns
```wenyan
/* 標準錯誤返回格式 Standard error return format */
吾有一言。名之曰「錯誤前綴」。
昔之「錯誤前綴」者。今「「錯誤：」」是矣。

吾有一言。名之曰「成功標記」。
昔之「成功標記」者。今「「成功」」是矣。
```

### 函數復雜度控制 Function Complexity Control

#### 單一職責原則 Single Responsibility Principle
```wenyan
/* ❌ 違反單一職責原則 Violates SRP */
吾有一術。名之曰「處理用戶數據並發送郵件」。欲行是術。
    [驗證用戶數據]
    [格式化數據] 
    [保存到數據庫]
    [發送確認郵件]
    [記錄日誌]
是謂「處理用戶數據並發送郵件」之術也。

/* ✅ 遵循單一職責原則 Follows SRP */
吾有一術。名之曰「驗證用戶數據」。欲行是術。
    [只負責數據驗證]
是謂「驗證用戶數據」之術也。

吾有一術。名之曰「保存用戶數據」。欲行是術。
    [只負責數據保存]
是謂「保存用戶數據」之術也。

吾有一術。名之曰「發送確認郵件」。欲行是術。
    [只負責郵件發送]
是謂「發送確認郵件」之術也。
```

#### 循環複雜度限制 Cyclomatic Complexity Limits
- **簡單函數**：循環複雜度 ≤ 5
- **中等函數**：循環複雜度 ≤ 10  
- **複雜函數**：循環複雜度 ≤ 15（需要充分的測試和文檔）

```wenyan
/* ✅ 低複雜度函數示例 Low complexity example */
吾有一術。名之曰「計算絕對值」。欲行是術。必先得一數。曰「輸入數值」。乃行是術曰。
    若「輸入數值」小於〇者。
        减〇以「輸入數值」。乃得其也。
    云云。
    乃得「輸入數值」。
是謂「計算絕對值」之術也。
```

---

## 🚨 錯誤處理 Error Handling

### 統一錯誤處理模式 Unified Error Handling Pattern

所有庫函數必須遵循標準錯誤處理模式：

```wenyan
/* 引入錯誤處理標準 */
引用「錯誤處理標準」。

吾有一術。名之曰「示例標準函數」。欲行是術。
必先得一言。曰「輸入參數」。
乃行是術曰。
    
    /* 步驟1：參數驗證 Parameter Validation */
    施「驗證非空參數」於「輸入參數」於「「輸入參數」」。名之曰「驗證結果」。
    若「驗證結果」等於陰者。
        /* 返回標準化錯誤信息 */
        施「格式化錯誤信息」於「錯誤類型參數」於「示例函數」於「輸入參數為空」。
        乃得其也。
    云云。
    
    /* 步驟2：邊界條件檢查 Boundary Checks */
    [邊界檢查邏輯]
    
    /* 步驟3：核心邏輯執行 Core Logic */
    [核心功能實現]
    
    /* 步驟4：結果驗證 Result Validation */
    [結果檢查]
    
    /* 步驟5：返回結果 Return Result */
    乃得「處理結果」。
是謂「示例標準函數」之術也。
```

### 錯誤信息國際化 Error Message Internationalization
```wenyan
/* 錯誤信息應提供中英文版本 */
吾有一術。名之曰「報告雙語錯誤」。欲行是術。
必先得二言。曰「中文錯誤信息」。曰「英文錯誤信息」。
乃行是術曰。
    書之「❌ 」。書之「中文錯誤信息」。
    書之「❌ 」。書之「英文錯誤信息」。
是謂「報告雙語錯誤」之術也。
```

### 錯誤恢復策略 Error Recovery Strategies
```wenyan
/* 提供優雅的錯誤恢復機制 */
吾有一術。名之曰「帶重試的網絡請求」。欲行是術。
必先得一言一數。曰「請求地址」。曰「最大重試次數」。
乃行是術曰。
    
    吾有一數。名之曰「當前重試次數」。
    昔之「當前重試次數」者。今一是矣。
    
    恆為是。
        /* 嘗試執行操作 */
        [網絡請求邏輯]
        
        若「請求成功」等於陽者。
            乃得「請求結果」。
        云云。
        
        /* 檢查是否達到最大重試次數 */
        施「重試操作」於「最大重試次數」於「當前重試次數」於「網絡請求」。
        名之曰「重試結果」。
        
        若「重試結果」等於陰者。
            施「格式化錯誤信息」於「錯誤類型網絡」於「網絡請求」於「超過最大重試次數」。
            乃得其也。
        云云。
        
        加「當前重試次數」以一。昔之「當前重試次數」者。今其是矣。
    云云。
是謂「帶重試的網絡請求」之術也。
```

---

## 🧪 測試要求 Testing Requirements

### 測試覆蓋率要求 Test Coverage Requirements

每個公開函數必須提供：
1. **正常情況測試**：至少2個正常使用場景
2. **邊界條件測試**：至少2個邊界條件
3. **錯誤情況測試**：至少1個錯誤處理場景

```wenyan
/* 引入增強測試框架 */
引用「增強測試框架」。

/* 測試函數示例 */
吾有一術。名之曰「測試字符串長度計算」。欲行是術。乃行是術曰。
    施「設置測試套件名稱」於「「字符串長度計算測試」」。
    施「重置增強測試計數器」。
    
    /* 正常情況測試 Normal Case Tests */
    施「增強斷言相等」於三於施「計算字符串長度」於「「ABC」」於「「普通字符串長度測試」」於「「單元測試」」。
    施「增強斷言相等」於〇於施「計算字符串長度」於「「」」於「「空字符串長度測試」」於「「單元測試」」。
    
    /* 邊界條件測試 Boundary Tests */
    施「增強斷言相等」於一於施「計算字符串長度」於「「中」」於「「單字符長度測試」」於「「單元測試」」。
    
    /* 錯誤情況測試 Error Case Tests */
    施「增強斷言相等」於「「錯誤：參數不能為空」」於施「計算字符串長度」於「」於「「空參數錯誤測試」」於「「單元測試」」。
    
    /* 生成測試報告 */
    施「生成詳細測試報告」。
是謂「測試字符串長度計算」之術也。
```

### 性能測試標準 Performance Testing Standards
```wenyan
/* 引入性能測試框架 */
引用「增強性能測試框架」。

吾有一術。名之曰「測試字符串處理性能」。欲行是術。乃行是術曰。
    /* 基準性能測試 */
    施「執行性能基準測試」於「「字符串長度計算」」於「「測試基礎字符串操作性能」」。
    名之曰「基準執行時間」。
    
    /* 性能斷言 */
    施「斷言性能達標」於「「字符串長度計算」」於「基準執行時間」於十。  /* 10ms閾值 */
    
    /* 負載測試 */
    施「執行負載測試」於「「字符串處理負載測試」」於「「大量字符串處理」」於二。
    
    施「生成性能測試綜合報告」於「「字符串庫」」。
是謂「測試字符串處理性能」之術也。
```

### 測試數據管理 Test Data Management
```wenyan
/* 測試數據生成和管理 */
吾有一術。名之曰「準備測試數據」。欲行是術。乃行是術曰。
    /* 生成各種類型的測試數據 */
    施「生成測試字符串」於五。名之曰「短字符串」。
    施「生成測試字符串」於一百。名之曰「長字符串」。
    施「生成測試數列」於十。名之曰「數字列表」。
    
    /* 特殊測試用例 */
    吾有一言。名之曰「Unicode字符串」。
    昔之「Unicode字符串」者。今「「Hello 世界 🌍」」是矣。
    
    吾有一言。名之曰「特殊字符串」。  
    昔之「特殊字符串」者。今「「\n\t\r\"\'\\」」是矣。
    
    /* 返回測試數據集合 */
    吾有一列。名之曰「測試數據集」。
    充「測試數據集」以「短字符串」。
    充「測試數據集」以「長字符串」。
    充「測試數據集」以「Unicode字符串」。
    充「測試數據集」以「特殊字符串」。
    
    乃得「測試數據集」。
是謂「準備測試數據」之術也。
```

---

## ⚡ 性能考量 Performance Considerations

### 性能目標 Performance Targets

| 操作類型 | 目標時間 | 內存使用 | 備註 |
|---------|---------|----------|------|
| 基礎操作 | < 10ms | < 1MB | 如字符串長度計算 |
| 標準操作 | < 100ms | < 10MB | 如排序、查找 |
| 複雜操作 | < 1000ms | < 100MB | 如複雜算法、大數據處理 |

### 性能優化原則 Performance Optimization Principles

#### 算法複雜度優先 Algorithm Complexity First
```wenyan
/* ✅ 使用高效算法 Use efficient algorithms */
吾有一術。名之曰「二分查找」。欲行是術。
必先得一列一數。曰「已排序數組」。曰「目標值」。
乃行是術曰。
    /* O(log n) 時間複雜度 */
    [二分查找實現]
是謂「二分查找」之術也。

/* ❌ 避免低效算法 Avoid inefficient algorithms */
吾有一術。名之曰「線性查找」。欲行是術。
必先得一列一數。曰「數組」。曰「目標值」。
乃行是術曰。
    /* O(n) 時間複雜度 - 僅在必要時使用 */
    [線性查找實現]
是謂「線性查找」之術也。
```

#### 內存使用優化 Memory Usage Optimization
```wenyan
/* 及時釋放大型數據結構 */
吾有一術。名之曰「處理大型數據」。欲行是術。
必先得一列。曰「大型數據集」。
乃行是術曰。
    
    /* 分批處理以控制內存使用 Process in batches to control memory */
    吾有一數。名之曰「批次大小」。
    昔之「批次大小」者。今一千是矣。
    
    [分批處理邏輯]
    
    /* 清理臨時數據 Clean up temporary data */
    吾有一列。名之曰「空列表」。
    昔之「臨時數據」者。今「空列表」是矣。
是謂「處理大型數據」之術也。
```

#### 緩存策略 Caching Strategies
```wenyan
/* 計算結果緩存 */
吾有一列。名之曰「計算結果緩存」。

吾有一術。名之曰「帶緩存的複雜計算」。欲行是術。
必先得一數。曰「輸入值」。
乃行是術曰。
    
    /* 檢查緩存 Check cache */
    施「查找緩存結果」於「輸入值」。名之曰「緩存結果」。
    若「緩存結果」不等於「「未找到」」者。
        乃得「緩存結果」。
    云云。
    
    /* 執行複雜計算 Perform complex calculation */
    [複雜計算邏輯]
    
    /* 存儲到緩存 Store to cache */
    施「存儲緩存結果」於「輸入值」於「計算結果」。
    
    乃得「計算結果」。
是謂「帶緩存的複雜計算」之術也。
```

### 性能測試和監控 Performance Testing and Monitoring
```wenyan
/* 性能基準測試 */
吾有一術。名之曰「建立性能基準」。欲行是術。
必先得一言。曰「函數名稱」。
乃行是術曰。
    
    施「執行性能基準測試」於「函數名稱」於「「建立性能基準」」。
    名之曰「基準時間」。
    
    /* 記錄基準數據 */
    [基準數據記錄邏輯]
    
    乃得「基準時間」。
是謂「建立性能基準」之術也。
```

---

## 👥 代碼審查 Code Review

### 代碼審查檢查清單 Code Review Checklist

#### 功能性檢查 Functionality Checks
- [ ] 函數是否正確實現了規定的功能？
- [ ] 是否處理了所有邊界條件？
- [ ] 錯誤處理是否完整和恰當？
- [ ] 是否有潛在的邏輯錯誤？

#### 代碼質量檢查 Code Quality Checks  
- [ ] 變量和函數命名是否清晰和一致？
- [ ] 代碼結構是否清晰和易於理解？
- [ ] 是否遵循了編碼標準？
- [ ] 註釋是否充分和準確？

#### 性能檢查 Performance Checks
- [ ] 算法複雜度是否合理？
- [ ] 是否有不必要的計算或內存使用？
- [ ] 是否考慮了大數據量的處理？
- [ ] 是否有潛在的性能瓶頸？

#### 測試檢查 Testing Checks
- [ ] 測試覆蓋率是否達到要求？
- [ ] 測試用例是否覆蓋了關鍵場景？
- [ ] 性能測試是否通過？
- [ ] 是否有充分的錯誤情況測試？

### 代碼審查模板 Code Review Template
```markdown
## 代碼審查報告 Code Review Report

**審查者 Reviewer**: [審查者姓名]  
**審查日期 Review Date**: [日期]  
**被審查代碼 Code Under Review**: [文件名和函數名]

### 總體評價 Overall Assessment
- [ ] 批准 Approved
- [ ] 需要修改 Needs Changes  
- [ ] 拒絕 Rejected

### 詳細反饋 Detailed Feedback

#### 優點 Strengths
- [列出代碼的優點]

#### 需要改進的地方 Areas for Improvement
- [列出具體的改進建議]

#### 必須修改的問題 Critical Issues
- [列出必須修改的問題]

### 建議 Recommendations
- [提供具體的改進建議]

**Author: Whisky, PR Worker**
```

---

## 💡 示例代碼 Example Code

### 完整的庫函數示例 Complete Library Function Example
```wenyan
/*
 * 字符串查找函數 - String Search Function
 * 
 * 功能描述 Description:
 * 在主字符串中查找子字符串的位置，支持大小寫敏感/不敏感查找
 * Search for substring position in main string with case sensitive/insensitive support
 * 
 * 參數 Parameters:
 * @param {言} 主字符串 - 被搜索的主字符串 Main string to search in
 * @param {言} 子字符串 - 要查找的子字符串 Substring to find
 * @param {爻} 區分大小寫 - 是否區分大小寫 Whether to match case
 * 
 * 返回值 Returns:
 * @return {數|言} 找到時返回位置(從1開始)，未找到返回"未找到"
 *                Returns position (1-based) if found, "未找到" if not found
 * 
 * 異常 Exceptions:
 * @throws 參數錯誤 當參數為空或無效時
 * 
 * 示例 Example:
 * 施「在字符串中查找」於「「Hello World」」於「「World」」於陽。
 * 
 * 性能 Performance: O(n*m) 其中n為主字符串長度，m為子字符串長度
 * 線程安全 Thread Safety: 安全 Safe
 * 版本 Since: 2.0.0
 * 作者 Author: Whisky, PR Worker
 */
吾有一術。名之曰「在字符串中查找」。欲行是術。
必先得二言一爻。曰「主字符串」。曰「子字符串」。曰「區分大小寫」。
乃行是術曰。
    
    /* 參數驗證 Parameter Validation */
    施「驗證非空參數」於「主字符串」於「「主字符串」」。名之曰「主字符串驗證」。
    若「主字符串驗證」等於陰者。
        施「格式化錯誤信息」於「錯誤類型參數」於「字符串查找」於「主字符串不能為空」。
        乃得其也。
    云云。
    
    施「驗證非空參數」於「子字符串」於「「子字符串」」。名之曰「子字符串驗證」。
    若「子字符串驗證」等於陰者。
        施「格式化錯誤信息」於「錯誤類型參數」於「字符串查找」於「子字符串不能為空」。
        乃得其也。
    云云。
    
    /* 邊界條件檢查 Boundary Checks */
    夫「主字符串」之長。名之曰「主字符串長度」。
    夫「子字符串」之長。名之曰「子字符串長度」。
    
    若「子字符串長度」大於「主字符串長度」者。
        乃得「「未找到」」。
    云云。
    
    /* 核心搜索邏輯 Core Search Logic */
    吾有一數。名之曰「搜索位置」。
    昔之「搜索位置」者。今一是矣。
    
    恆為是。
        /* 檢查是否超出搜索範圍 */
        若「搜索位置」加「子字符串長度」減一大於「主字符串長度」者。
            乃止。
        云云。
        
        /* 提取當前位置的子串進行比較 */
        夫「主字符串」自「搜索位置」至「搜索位置」加「子字符串長度」減一。
        名之曰「當前子串」。
        
        /* 根據大小寫設置進行比較 */
        吾有一爻。名之曰「匹配結果」。
        若「區分大小寫」等於陽者。
            若「當前子串」等於「子字符串」者。
                昔之「匹配結果」者。今陽是矣。
            云云。
        云云。
        若「區分大小寫」等於陰者。
            /* 轉換為小寫進行比較 Convert to lowercase for comparison */
            施「轉換為小寫」於「當前子串」。名之曰「小寫當前子串」。
            施「轉換為小寫」於「子字符串」。名之曰「小寫子字符串」。
            若「小寫當前子串」等於「小寫子字符串」者。
                昔之「匹配結果」者。今陽是矣。
            云云。
        云云。
        
        /* 如果匹配成功，返回位置 */
        若「匹配結果」等於陽者。
            乃得「搜索位置」。
        云云。
        
        /* 移動到下一個位置 */
        加「搜索位置」以一。昔之「搜索位置」者。今其是矣。
    云云。
    
    /* 未找到匹配 */
    乃得「「未找到」」。
是謂「在字符串中查找」之術也。
```

### 對應的測試代碼示例 Corresponding Test Code Example
```wenyan
/*
 * 字符串查找函數測試 - String Search Function Tests
 * Author: Whisky, PR Worker
 */

引用「增強測試框架」。
引用「字符串處理」。

吾有一術。名之曰「測試字符串查找功能」。欲行是術。乃行是術曰。
    施「設置測試套件名稱」於「「字符串查找功能測試」」。
    施「重置增強測試計數器」。
    
    書之「開始執行字符串查找功能測試...」。
    
    /* ===== 正常情況測試 Normal Case Tests ===== */
    施「開始測試組」於「「正常情況測試」」。
    
    /* 基本查找測試 */
    施「增強斷言相等」於七於
        施「在字符串中查找」於「「Hello World」」於「「World」」於陽於
        「「基本子字符串查找」」於「「單元測試」」。
    
    /* 區分大小寫測試 */
    施「增強斷言相等」於「「未找到」」於
        施「在字符串中查找」於「「Hello World」」於「「world」」於陽於
        「「區分大小寫查找」」於「「單元測試」」。
    
    /* 不區分大小寫測試 */
    施「增強斷言相等」於七於
        施「在字符串中查找」於「「Hello World」」於「「world」」於陰於
        「「不區分大小寫查找」」於「「單元測試」」。
    
    施「完成測試組」於「「正常情況測試」」。
    
    /* ===== 邊界條件測試 Boundary Tests ===== */
    施「開始測試組」於「「邊界條件測試」」。
    
    /* 空字符串測試 */
    施「增強斷言相等」於一於
        施「在字符串中查找」於「「ABC」」於「「」」於陽於
        「「查找空子字符串」」於「「單元測試」」。
    
    /* 子字符串比主字符串長 */
    施「增強斷言相等」於「「未找到」」於
        施「在字符串中查找」於「「ABC」」於「「ABCDEF」」於陽於
        「「子字符串過長」」於「「單元測試」」。
    
    /* 完全匹配測試 */
    施「增強斷言相等」於一於
        施「在字符串中查找」於「「Hello」」於「「Hello」」於陽於
        「「完全匹配查找」」於「「單元測試」」。
    
    /* 查找第一個字符 */
    施「增強斷言相等」於一於
        施「在字符串中查找」於「「Hello」」於「「H」」於陽於
        「「查找首字符」」於「「單元測試」」。
    
    /* 查找最後一個字符 */
    施「增強斷言相等」於五於
        施「在字符串中查找」於「「Hello」」於「「o」」於陽於
        「「查找尾字符」」於「「單元測試」」。
    
    施「完成測試組」於「「邊界條件測試」」。
    
    /* ===== 錯誤情況測試 Error Case Tests ===== */
    施「開始測試組」於「「錯誤情況測試」」。
    
    /* 主字符串為空的錯誤 */
    吾有一言。名之曰「空主字符串結果」。
    施「在字符串中查找」於「」於「「test」」於陽。名之曰「空主字符串結果」。
    施「斷言為真」於
        (夫「空主字符串結果」之「一」至「二」等於「「錯誤」」)於
        「「空主字符串錯誤處理」」。
    
    /* 子字符串為空的錯誤 */  
    吾有一言。名之曰「空子字符串結果」。
    施「在字符串中查找」於「「Hello」」於「」於陽。名之曰「空子字符串結果」。
    施「斷言為真」於
        (夫「空子字符串結果」之「一」至「二」等於「「錯誤」」)於
        「「空子字符串錯誤處理」」。
    
    施「完成測試組」於「「錯誤情況測試」」。
    
    /* ===== 性能測試 Performance Tests ===== */
    施「開始測試組」於「「性能測試」」。
    
    /* 基本性能測試 */
    施「開始性能計時」於「「字符串查找性能測試」」。
    施「在字符串中查找」於「「這是一個很長的測試字符串用來測試查找功能的性能表現」」於「「功能」」於陽。
    施「結束性能計時」。名之曰「查找執行時間」。
    
    施「斷言性能達標」於「「字符串查找性能」」於「查找執行時間」於十。
    
    施「完成測試組」於「「性能測試」」。
    
    /* ===== 生成測試報告 Generate Test Report ===== */
    施「分析測試覆蓋率」於八於八。  /* 8個測試函數，8個已測試 */
    施「生成詳細測試報告」。
    
    書之「字符串查找功能測試完成！」。
是謂「測試字符串查找功能」之術也。

/* 執行測試 */
施「測試字符串查找功能」。
```

---

## 🔧 工具和檢查 Tools and Validation

### 自動化檢查工具 Automated Validation Tools

#### 語法檢查腳本 Syntax Validation Script
```bash
#!/bin/bash
# 文言代碼語法檢查 - Wenyan Code Syntax Validation
# Author: Whisky, PR Worker

echo "🔍 開始語法檢查 Starting syntax validation..."

find . -name "*.wy" -type f | while read -r file; do
    echo "檢查文件 Checking: $file"
    
    if wenyan --check "$file"; then
        echo "✅ $file 語法正確 Syntax OK"
    else
        echo "❌ $file 語法錯誤 Syntax Error"
        exit 1
    fi
done

echo "🎉 所有文件語法檢查通過 All files passed syntax validation"
```

#### 編碼標準檢查腳本 Coding Standards Validation Script
```bash
#!/bin/bash  
# 編碼標準檢查 - Coding Standards Validation
# Author: Whisky, PR Worker

check_file_standards() {
    local file="$1"
    local issues=0
    
    echo "📋 檢查文件標準 Checking standards for: $file"
    
    # 檢查文件頭部註釋
    if ! head -10 "$file" | grep -q "Author:"; then
        echo "⚠️  缺少作者信息 Missing author information"
        ((issues++))
    fi
    
    # 檢查函數註釋
    if grep -q "吾有一術.*欲行是術" "$file"; then
        if ! grep -B5 "吾有一術" "$file" | grep -q "/\*"; then
            echo "⚠️  函數缺少註釋 Function missing documentation"
            ((issues++))
        fi
    fi
    
    # 檢查命名規範 
    if grep -q "[a-zA-Z]" "$file"; then
        echo "⚠️  發現英文命名，建議使用中文 English naming found, recommend Chinese"
        ((issues++))
    fi
    
    return $issues
}

# 檢查所有.wy文件
total_issues=0
find . -name "*.wy" -type f | while read -r file; do
    check_file_standards "$file"
    total_issues=$((total_issues + $?))
done

if [ $total_issues -eq 0 ]; then
    echo "🎉 編碼標準檢查通過 Coding standards validation passed"
    exit 0
else
    echo "❌ 發現 $total_issues 個標準問題 Found $total_issues standard issues"
    exit 1
fi
```

### 開發工具配置 Development Tools Configuration

#### VS Code 配置示例 VS Code Configuration Example
```json
{
    "files.associations": {
        "*.wy": "wenyan"
    },
    "editor.rulers": [80],
    "editor.insertSpaces": true,
    "editor.tabSize": 4,
    "files.encoding": "utf8",
    "editor.wordWrap": "wordWrapColumn",
    "editor.wordWrapColumn": 80
}
```

#### Git 鉤子配置 Git Hooks Configuration
```bash
#!/bin/sh
# .git/hooks/pre-commit
# 提交前檢查 - Pre-commit validation
# Author: Whisky, PR Worker

echo "🔍 執行提交前檢查 Running pre-commit validation..."

# 語法檢查
./tools/syntax_check.sh
if [ $? -ne 0 ]; then
    echo "❌ 語法檢查失敗 Syntax validation failed"
    exit 1
fi

# 編碼標準檢查  
./tools/standards_check.sh
if [ $? -ne 0 ]; then
    echo "❌ 編碼標準檢查失敗 Coding standards validation failed"
    exit 1
fi

# 運行測試
./增強測試運行器.sh
if [ $? -ne 0 ]; then
    echo "❌ 測試失敗 Tests failed"
    exit 1
fi

echo "✅ 所有檢查通過 All validations passed"
exit 0
```

---

## 📚 總結 Summary

本編碼標準指南為文言編程標準庫開發提供了全面的規範和最佳實踐。遵循這些標準將確保：

- **代碼質量一致性**：所有庫函數保持統一的高質量標準
- **可維護性**：清晰的結構和註釋使代碼易於維護和擴展  
- **文化適宜性**：保持文言編程的傳統特色和優雅風格
- **國際化支持**：提供中英文雙語支持，便於國際用戶使用
- **性能保證**：通過性能測試和優化確保庫函數高效運行
- **健壯性**：完善的錯誤處理和邊界檢查確保代碼穩定可靠

### 關鍵要點 Key Points
1. **命名規範**：使用清晰的中文描述性名稱
2. **函數設計**：單一職責，完整的參數驗證和錯誤處理
3. **測試要求**：100%測試覆蓋率，包含性能測試
4. **文檔標準**：詳細的中英文註釋和使用示例
5. **性能目標**：明確的性能基準和優化要求
6. **代碼審查**：系統性的審查流程和質量保證

遵循本標準，我們將建設一個高質量、易用、高效的文言編程標準庫，為文言編程語言的發展做出貢獻。

**Author: Whisky, PR Worker**  
**維護 Maintained by**: 文言標準庫開發團隊